<!DOCTYPE html>
<HTML>
<!-- 
– use'ajax'call'to'/checkLogin.php'file'to'check'user/password
– on'success'go'to'viewPosts.php
– on'failure'– ask'the'user'to'correct'the'username'and'password 
-->
<HEAD>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="posts.css">
</HEAD>
<BODY>

<div class="loginDiv">
<p>Username</p>
<input type="text" name="username" id="username"/> <br>
<p>Password</p>
<input type="text" name="password" id="password"/> <br>
<input type="button" value="Login" id="login" />

</div>

<div class="app">
	<div class="viewPosts"></div>
	<div class="createPosts">
		<p>Submit a new Post</p>
		<input type="text" id="Title" placeholder="Title" /> <br>
		<input type="text" id="Message" placeholder="Message" size="50"/>
		<input type="button" id="submit" value="Submit" style="background:lightblue"/>
	</div>
</div>

</BODY>

<script> 
$(document).ready(function() {

$(".app").hide();
$('.createPosts').hide();

$("#submit").click(function() {
	console.log("Adding post:");
	console.log("\tTitle: " + $("#Title").val());
	console.log("\tMessage: " + $("#Message").val());
	
	$.post("updatePosts.php", {title: $("#Title").val(), message: $("#Message").val()}, 
		function(data) {	
			console.log("data: " + data);
			console.log("Added a post, now attempting to refresh the page");}).done(
			function() {
				$.post("viewPosts.php", {username: $("#username").val()}, function(data) {
					$('.viewPosts').html(data);
					console.log("...Refresh Successful!");
				});
			});
});

$("#login").click (function () {
  
  req = "username=" + $("#username").val();
  req += "&password=" + $("#password").val();
  
  console.log("checkLogin.php?" + req);
  $.get("checkLogin.php?" + req, 
        function(data,status) {
			console.log("Login was successful: " + data);
			if ( data == "true" ) {
				$(".loginDiv,.app").toggle();
				$('.createPosts').show();
				$.post("viewPosts.php", {username: $("#username").val()},
					function (data) {
						$(".viewPosts").html(data);
					});
			}
			else {
				alert("Incorrect login information");
				$("#username").val("");
				$("#password").val("");
			}
   });
});


}); // end of document ready function

</script>

</HTML>